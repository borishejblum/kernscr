<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find an interval constraining the rho parameter for a non linear kernel — findRhoInterval • kernscr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find an interval constraining the rho parameter for a non linear kernel — findRhoInterval"><meta name="description" content="Find an interval constraining the rho parameter for a non linear kernel"><meta property="og:description" content="Find an interval constraining the rho parameter for a non linear kernel"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kernscr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/borishejblum/kernscr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find an interval constraining the rho parameter for a non linear kernel</h1>
      <small class="dont-index">Source: <a href="https://github.com/borishejblum/kernscr/blob/master/R/findRhoInterval.R" class="external-link"><code>R/findRhoInterval.R</code></a></small>
      <div class="d-none name"><code>findRhoInterval.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Find an interval constraining the rho parameter for a non linear kernel</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">findRhoInterval</span><span class="op">(</span></span>
<span>  <span class="va">tZ</span>,</span>
<span>  rho_init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">20</span>, length <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tZ</span><span class="op">)</span>,</span>
<span>  kernel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gaussian"</span>, <span class="st">"poly"</span><span class="op">)</span>,</span>
<span>  d <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  rate_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  pca_thres <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  warning_suppress <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tz">tZ<a class="anchor" aria-label="anchor" href="#arg-tz"></a></dt>
<dd><p>a <code>P x N</code> matrix of genomic covariates (i.e., the usual data array Z transposed)</p></dd>


<dt id="arg-rho-init">rho_init<a class="anchor" aria-label="anchor" href="#arg-rho-init"></a></dt>
<dd><p>an initial large range of possible rhos, which will be considered to see if they are
reasonable tuning parameters for the kernel. Default is <code>seq(0.01, 20, length=300)*P</code>. See Details.</p></dd>


<dt id="arg-kernel">kernel<a class="anchor" aria-label="anchor" href="#arg-kernel"></a></dt>
<dd><p>character string specifying a nonlinear kernel. Currently supported options are:
<code>"gaussian"</code> or <code>"poly"</code></p></dd>


<dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>if <code>kernel</code> is <code>"poly"</code>, the polynomial power (e.g. d=2 for quadratic kernel).
Default is <code>NA</code>.</p></dd>


<dt id="arg-rate-range">rate_range<a class="anchor" aria-label="anchor" href="#arg-rate-range"></a></dt>
<dd><p>a vector of length 2 indicating the range of alpha in the paper. Default is <code>c(1.5,4)</code>.</p></dd>


<dt id="arg-pca-thres">pca_thres<a class="anchor" aria-label="anchor" href="#arg-pca-thres"></a></dt>
<dd><p>a number between <code>0</code> and <code>1</code> giving the threshold to be used for PCA.
Default is <code>0.9</code>. If <code>NULL</code>, no PCA is performed.</p></dd>


<dt id="arg-warning-suppress">warning_suppress<a class="anchor" aria-label="anchor" href="#arg-warning-suppress"></a></dt>
<dd><p>logical flag. Indicating whether the warnings should be suppress during
the linear model fitting step. Default is <code>TRUE</code>. See details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>an upper and lower bound to look for rho</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function will print <code>rho_init</code> range and the range of valid tuning parameters.
If that range butts up against either the upper or lower bound of <code>rho_init</code>, you can rerun this function
with a bigger <code>rho_init</code>.</p>
<p>Finding the right tuning parameters includes a step of fitting a linear model which can fail
because some tuning parameters yield only one eigenvector. We want to eliminate those tuning parameters,
so this is OK. However, in case one want to suppress (numerous) annoying warning messages, use the
<code>warning_suppress</code> argument.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## First generate some Data</span></span></span>
<span class="r-in"><span><span class="va">feat_m_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">feat_d_fun</span> <span class="op">&lt;-</span>  <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span> <span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">-</span><span class="va">X</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="fl">8</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_SCR_data.html">sim_SCR_data</a></span><span class="op">(</span>data_size <span class="op">=</span> <span class="fl">400</span>, ncol_gene_mat <span class="op">=</span> <span class="fl">20</span>, feat_m <span class="op">=</span> <span class="va">feat_m_fun</span>,</span></span>
<span class="r-in"><span>                      feat_d <span class="op">=</span> <span class="va">feat_d_fun</span>, mu_cen <span class="op">=</span> <span class="fl">30</span>, cov<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#initial range</span></span></span>
<span class="r-in"><span><span class="va">ind_gene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_rho_init</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">20</span>, length<span class="op">=</span><span class="fl">300</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ind_gene</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">my_rho_init</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]   0.2 400.0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># compute the interval for rho</span></span></span>
<span class="r-in"><span><span class="va">rho_set</span> <span class="op">&lt;-</span> <span class="fu">findRhoInterval</span><span class="op">(</span>tZ<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">[</span>,<span class="va">ind_gene</span><span class="op">]</span><span class="op">)</span>, rho_init <span class="op">=</span> <span class="va">my_rho_init</span>, kernel<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rho_set</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">my_rho_init</span><span class="op">)</span> <span class="co"># good to check that the interval produced here is strictly contained in rho_init</span></span></span>
<span class="r-in"><span><span class="co"># otherwise, expand rho.init and rerun</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#rhos &lt;- exp(seq(log(rho_set[1]),log(rho_set[2]), length=50))</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://mateyneykov.com/" class="external-link">Matey Neykov</a>, <a href="https://borishejblum.science" class="external-link">Boris P Hejblum</a>, <a href="https://stat.osu.edu/people/sinnott.12" class="external-link">Jennifer A Sinnot</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

